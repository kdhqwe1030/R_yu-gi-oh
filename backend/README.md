# 1. í™˜ê²½ ì„¤ì •

```python
C:\Users\jjj53\anaconda3\Scripts\activate.bat

conda create -n "R_yu-gi-oh-project" python=3.7
conda activate "R_yu-gi-oh-project"
django-admin startproject Ryugiohproject
cd ./Ryugiohproject
python manage.py runserver
python manage.py startapp Ryugiohproject_app
```

Ryugiohproject/settings.pyì— ì¶”ê°€

```python
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'Ryugiohproject_app'
]
```

ì¥ê³  í”„ë ˆì„ì›Œí¬ì˜ ê¸°ë³¸ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

![alt text](image.png)
Ryugiohproject/urls.pyì—ì„œ urlì„ ì„¤ì •í•˜ê³ , Ryugiohproject_app/urls.pyì—ì„œ í•´ë‹¹ url ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì •ì˜í•  ìˆ˜ ìˆë‹¤. ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë·°ëŠ” views.pyì—ì„œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

---

# 2. íŒ¨í‚¤ì§€ êµ¬ì„±

```python
Ryugiohproject/
    manage.py
    Ryugiohproject/
        __init__.py
        settings.py
        urls.py
        wsgi.py
    Ryugiohproject_app/
        __init__.py
        admin.py
        apps.py
        models.py
        tests.py
        views.py
        urls.py
    db.sqlite3
    requirements.txt
```

í˜„ì¬ì˜ íŒ¨í‚¤ì§€ êµ¬ì„±ì´ë‹¤. í•˜ë‚˜ì”© ì‚´í´ë³´ì.

**1. `manage.py`**

ê¸°ë³¸ ìƒì„±ëœ ìƒíƒœ ê·¸ëŒ€ë¡œ ë‘”ë‹¤.

**2. `Ryugiohproject/` í´ë”**

- **`__init__.py`**: ë¹ˆ íŒŒì¼ë¡œ ë‘ê³ , Pythonì´ ì´ ë””ë ‰í„°ë¦¬ë¥¼ íŒ¨í‚¤ì§€ë¡œ ì¸ì‹í•˜ëŠ” ì—­í• ì„ í•œë‹¤.
- **`settings.py`**: Django í”„ë¡œì íŠ¸ì˜ ì„¤ì • íŒŒì¼ì´ë‹¤.

  - ì½”ë“œ ë³´ê¸°

    ```python
    """
    Django settings for Ryugiohproject project.

    Generated by 'django-admin startproject' using Django 3.2.25.

    For more information on this file, see
    https://docs.djangoproject.com/en/3.2/topics/settings/

    For the full list of settings and their values, see
    https://docs.djangoproject.com/en/3.2/ref/settings/
    """

    from pathlib import Path

    # Build paths inside the project like this: BASE_DIR / 'subdir'.
    BASE_DIR = Path(__file__).resolve().parent.parent

    # Quick-start development settings - unsuitable for production
    # See https://docs.djangoproject.com/en/3.2/howto/deployment/checklist/

    # SECURITY WARNING: keep the secret key used in production secret!
    SECRET_KEY = 'django-insecure-y^4so80urs-0)zpxi4p$!05i9t&-lhkv4_qm)$&j$a73y5d7v5'

    # SECURITY WARNING: don't run with debug turned on in production!
    DEBUG = True

    ALLOWED_HOSTS = []

    # Application definition

    INSTALLED_APPS = [
        'django.contrib.admin',
        'django.contrib.auth',
        'django.contrib.contenttypes',
        'django.contrib.sessions',
        'django.contrib.messages',
        'django.contrib.staticfiles',
        'Ryugiohproject_app'
    ]

    MIDDLEWARE = [
        'django.middleware.security.SecurityMiddleware',
        'django.contrib.sessions.middleware.SessionMiddleware',
        'django.middleware.common.CommonMiddleware',
        'django.middleware.csrf.CsrfViewMiddleware',
        'django.contrib.auth.middleware.AuthenticationMiddleware',
        'django.contrib.messages.middleware.MessageMiddleware',
        'django.middleware.clickjacking.XFrameOptionsMiddleware',
    ]

    ROOT_URLCONF = 'Ryugiohproject.urls'

    TEMPLATES = [
        {
            'BACKEND': 'django.template.backends.django.DjangoTemplates',
            'DIRS': [],
            'APP_DIRS': True,
            'OPTIONS': {
                'context_processors': [
                    'django.template.context_processors.debug',
                    'django.template.context_processors.request',
                    'django.contrib.auth.context_processors.auth',
                    'django.contrib.messages.context_processors.messages',
                ],
            },
        },
    ]

    WSGI_APPLICATION = 'Ryugiohproject.wsgi.application'

    # Database
    # https://docs.djangoproject.com/en/3.2/ref/settings/#databases

    DATABASES = {
        'default': {
            'ENGINE': 'django.db.backends.sqlite3',
            'NAME': BASE_DIR / 'db.sqlite3',
        }
    }

    # Password validation
    # https://docs.djangoproject.com/en/3.2/ref/settings/#auth-password-validators

    AUTH_PASSWORD_VALIDATORS = [
        {
            'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
        },
        {
            'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
        },
        {
            'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
        },
        {
            'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
        },
    ]

    # Internationalization
    # https://docs.djangoproject.com/en/3.2/topics/i18n/

    LANGUAGE_CODE = 'en-us'

    TIME_ZONE = 'UTC'

    USE_I18N = True

    USE_L10N = True

    USE_TZ = True

    # Static files (CSS, JavaScript, Images)
    # https://docs.djangoproject.com/en/3.2/howto/static-files/

    STATIC_URL = '/static/'

    # Default primary key field type
    # https://docs.djangoproject.com/en/3.2/ref/settings/#default-auto-field

    DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'
    ```

- **`urls.py`**: URL ë¼ìš°íŒ…ì„ ì •ì˜í•˜ëŠ” íŒŒì¼ì…ë‹ˆë‹¤.

  ```python
  """Ryugiohproject URL Configuration

  The `urlpatterns` list routes URLs to views. For more information please see:
      https://docs.djangoproject.com/en/3.2/topics/http/urls/
  Examples:
  Function views
      1. Add an import:  from my_app import views
      2. Add a URL to urlpatterns:  path('', views.home, name='home')
  Class-based views
      1. Add an import:  from other_app.views import Home
      2. Add a URL to urlpatterns:  path('', Home.as_view(), name='home')
  Including another URLconf
      1. Import the include() function: from django.urls import include, path
      2. Add a URL to urlpatterns:  path('blog/', include('blog.urls'))
  """
  from django.contrib import admin
  from django.urls import path

  urlpatterns = [
      path('admin/', admin.site.urls),
  ]
  ```

- **`wsgi.py`**: WSGI í˜¸í™˜ ì›¹ ì„œë²„ì—ì„œ ì´ Django í”„ë¡œì íŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•˜ëŠ” íŒŒì¼ì´ë‹¤. ì´ˆê¸° ìƒíƒœë¡œ ë‘ë©´ ëœë‹¤.

**3.** `Ryugiohproject_app` **í´ë”**

ì•±ì€ í”„ë¡œì íŠ¸ ë‚´ì—ì„œ íŠ¹ì • ê¸°ëŠ¥ì„ ë‹´ë‹¹í•˜ëŠ” ë‹¨ìœ„ì´ë‹¤.

- **`__init__.py`**: ë¹ˆ íŒŒì¼ë¡œ ë‘ë©´ ë˜ê³ , Pythonì´ ì´ ë””ë ‰í„°ë¦¬ë¥¼ íŒ¨í‚¤ì§€ë¡œ ì¸ì‹í•˜ë„ë¡ í•œë‹¤.
- **`admin.py`**: ê´€ë¦¬ì í˜ì´ì§€ì— ëª¨ë¸ì„ ë“±ë¡í•˜ëŠ” íŒŒì¼ì´ë‹¤.

  ```python
  from django.contrib import admin

  # Register your models here.
  ```

- **`apps.py`**: ì•±ì˜ ì„¤ì •ì„ ì •ì˜í•˜ëŠ” íŒŒì¼ì´ë‹¤.

  ```python
  from django.apps import AppConfig

  class RyugiohprojectAppConfig(AppConfig):
      default_auto_field = 'django.db.models.BigAutoField'
      name = 'Ryugiohproject_app'
  ```

- **`models.py`**: ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ì„ ì •ì˜í•˜ëŠ” íŒŒì¼ì´ë‹¤.

  ```python
  from django.db import models

  # Create your models here.
  ```

- **`tests.py`**: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‘ì„±í•˜ëŠ” íŒŒì¼ì´ë‹¤.

  ```python
  from django.test import TestCase

  # Create your tests here.
  ```

- **`views.py`**: ë·°ë¥¼ ì •ì˜í•˜ëŠ” íŒŒì¼ì´ë‹¤.

  ```python
  from django.shortcuts import render

  # Create your views here.
  ```

- **`urls.py`**: ì•±ì˜ URL ë¼ìš°íŒ…ì„ ì •ì˜í•˜ëŠ” íŒŒì¼ì´ë‹¤. ì´ íŒŒì¼ì€ ìˆ˜ë™ìœ¼ë¡œ ìƒì„±í•´ì•¼ í•œë‹¤.

  ```python
  from django.urls import path
  from . import views

  urlpatterns = [
      path('', views.index, name='index'),
  ]
  ```

**4. `db.sqlite3`**

SQLite ë°ì´í„°ë² ì´ìŠ¤ íŒŒì¼ë¡œ, ê¸°ë³¸ ì„¤ì •ì—ì„œëŠ” ìë™ìœ¼ë¡œ ìƒì„±ëœë‹¤.

---

# 3. git ì‚¬ìš©ë²• ì •ë¦¬

## 1. fork

ì›ë³¸ ë¦¬íŒŒì§€í† ë¦¬ë¥¼ forkí•˜ì—¬ ë‚´ ë¦¬íŒŒì§€í† ë¦¬ë¡œ ë”°ì˜¨ë‹¤.

https://github.com/jjj5306/R_yu-gi-oh

forkë¥¼ ì‚¬ìš©í•˜ë©´ íŒ€ì›ë“¤ê³¼ ê³µìœ í•˜ëŠ” ë¦¬íŒŒì§€í† ë¦¬ê°€ ì•„ë‹Œ, ë‚˜ë§Œì˜ ë¦¬í¬ì§€í† ë¦¬ê°€ ìƒê¸´ë‹¤.

## 2. clone + remote

fork ë”´ ë¦¬í¬ì§€í† ë¦¬ë¥¼ cloneí•˜ê³  remote ì„¤ì •ì€ ì›ë³¸ ë¦¬íŒŒì§€í† ë¦¬ì™€ fork ë¦¬íŒŒì§€í† ë¦¬ ë‘˜ ë‹¤ ì„¤ì •í•œë‹¤.

![alt text](image-1.png)

## 3.ê°œë°œ

ê¸°ë³¸ì ì¸ ê°œë°œ ë‹¨ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

1. ì´ìŠˆ ìƒì„±

   - ì •í•´ì§„ ê·œì¹™ì— ë”°ë¼ ì´ìŠˆë¥¼ ìƒì„±í•œë‹¤. ì´ë²ˆ í”„ë¡œì íŠ¸ì˜ ì´ìŠˆ ìƒì„± ê·œì¹™ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

   ```markdown
   ## Description for development features

   DBì˜ íŠ¹ì • ì¹¼ëŸ¼ì„ JSONìœ¼ë¡œ ë·°ì— ë„˜ê²¨ì£¼ê³  ëª¨ë¸ì— card set ì¶”ê°€

   ## Todo-lists

   - [ ] ì‚¼í™˜ì‹ , ì—‘ì¡°ë””ì•„, ê¶ê·¹ì˜ í‘¸ë¥¸ ëˆˆì˜ ë°±ë£¡ ì›°ì»´ í˜ì´ì§€ë¡œ ë„˜ê²¨ì£¼ê¸°
   - [ ] ë“±ì¥ì¸ë¬¼ ë³„ ë±ì„ ë³´ì—¬ì£¼ê¸° ìœ„í•´ ëª¨ë¸ì— card set ì¶”ê°€ ë° DB ì—°ë™
   ```

2. ìƒì„±í•œ ì´ìŠˆì™€ ê´€ë ¨ëœ ê¸°ëŠ¥ì„ ê°œë°œí•  ë¸ŒëŸ°ì¹˜ë¥¼ ìƒì„±í•œë‹¤.
3. ìƒì„±í•œ ë¸Œëœì¹˜ì—ì„œ ì‘ì—…í•œë‹¤.
4. add + commit + pull + push
   - push ì „ì— pullì„ í•´ë‘ëŠ” ìŠµê´€ì´ ì¢‹ë‹¤.

## 4. pull request

pushí•˜ê³  ë‚˜ë©´ githubì—ì„œ pull requestë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤. pull requestì˜ ê·œì¹™ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

```markdown
## ì œëª© :

feat(issue ë²ˆí˜¸): ê¸°ëŠ¥ëª…

## ğŸ” ì‘ì—… ë‚´ìš©

ê¸°ëŠ¥ì—ì„œ ì–´ë–¤ ë¶€ë¶„ì´ êµ¬í˜„ë˜ì—ˆëŠ”ì§€ ì„¤ëª…í•´ì£¼ì„¸ìš”

  <br/>

## ì´ë¯¸ì§€ ì²¨ë¶€

<img src="íŒŒì¼ì£¼ì†Œ" width="50%" height="50%"/>

<br/>

## ğŸ”§ ì•ìœ¼ë¡œì˜ ê³¼ì œ

  <br/>
```

ì´ë ‡ê²Œ prì„ ë‚ ë¦¬ê³  ë‚˜ë©´ ê´€ë¦¬ìê°€ ì›ë³¸ ë¦¬íŒŒì§€í† ë¦¬ì—ì„œ mergeí•  ìˆ˜ ìˆë‹¤. ê·¸ì œì„œì•¼ ì ìš©ì´ ë˜ëŠ” ê²ƒì´ë‹¤.

---

# 4. ë©”ì¸ í™”ë©´ ë§Œë“¤ê¸° with nodohyun

ëª¨ë¸ì„ ë„˜ê¸°ëŠ” ë™ì  í˜ì´ì§€ë¥¼ ë³´ì—¬ì£¼ëŠ” ì˜ˆì‹œë¥¼ í•œ ë²ˆ ì§œë³´ì•˜ë‹¤.

`Ryugiohproject/urls.py`

```python
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('Ryugiohproject_app.urls')),
]
```

`Ryugiohproject/models.py`

```python
from django.db import models

# Create your models here.

class Card(models.Model):
    name = models.CharField(max_length=100)
    description = models.TextField()
    attack_points = models.IntegerField()
    defense_points = models.IntegerField()

    def __str__(self):
        return self.name
```

`Ryugiohproject/Ryugiohproject_app/templates/index`

- ì½”ë“œ ë³´ê¸°

  ```python
  <!DOCTYPE html>
  <html lang="en">
    <head>
      {% load static %}
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Document</title>
      <style>
        html,
        body {
          height: 100%;
          margin: 0;
          background-color: black;
          scroll-behavior: smooth;
        }

        header {
          height: 64px;
          width: 100%;
          position: fixed;
          top: 0;
          z-index: 100;
          color: white;
          display: flex;
          justify-content: space-between;
          align-items: center;
        }
        .left-header {
          list-style: none;
          display: flex;
          margin-left: 10%;
        }
        .right-header {
          list-style: none;
          display: flex;
          margin-right: 10%;
        }
        li {
          margin: 5px 25px;
        }
        .bg-video {
          width: 100%;
          background-attachment: fixed;
        }
        .parent_div {
          margin-left: auto;
          margin-right: auto;
          margin-top: 1000px;
          width: 500px;
          height: 500px;
          background-color: red;
          box-shadow: 4px 4px 4px 3px rgba(0, 0, 0, 0.4);
        }
        .child_div {
          margin: 0% auto;
          width: 300px;
          height: 300px;
          background-color: blue;
        }
      </style>
    </head>
    <body>
      <header>
        <ul class="left-header">
          <li>í™ˆ í™”ë©´</li>
          <li>ì¹´ë“œ ë³´ê¸°</li>
          <li>ì¹´ë“œ ë³´ê¸°</li>
        </ul>
        <ul class="right-header">
          <li>ë¡œê·¸ì¸</li>
          <li>ì¢‹ì•„ìš”</li>
          <li>ë‚´ ì •ë³´</li>
        </ul>
      </header>
      <div class="bg-video">
        <video class="bg-video__content" autoplay muted loop>
          <source src="{% static 'video.mp4' %}" type="video/mp4" />
        </video>
      </div>
      <div class="parent_div">
        <div class="child_div"></div>
      </div>
    </body>
  </html>

  ```

`Ryugiohproject/Ryugiohproject_app/views.py`

```python
from django.shortcuts import render
from .models import Card

# Create your views here.

def index(request):
    cards = Card.objects.all()
    return render(request, 'index.html', {'cards': cards})
```

`Ryugiohproject/settings.py` ì•„ë˜ ë‚´ìš© ì¶”ê°€(static ì»¨í…ì¸ )

```python
STATIC_URL = '/static/'

STATICFILES_DIRS = [
    os.path.join(BASE_DIR, 'static'),
]
```

video.mp4ë¥¼ ë³´ì—¬ì£¼ê¸° ìœ„í•´ í”„ë¡œì íŠ¸ ìµœìƒë‹¨ì— static ë””ë ‰í„°ë¦¬ ìƒì„± í›„ video.mp4ë¥¼ ì˜®ê¹€

```python
Ryugiohproject/
    Ryugiohproject_app/
    Ryugiohproject/
    static/
        video.mp4
    manage.py
```

## ì„œë²„ í‚¤ê³  í…ŒìŠ¤íŠ¸í•˜ê¸°

![alt text](image-2.png)

```python
python manage.py makemigrations
python manage.py migrate
python manage.py runserver
```

ëª¨ë¸ ìƒì„± í›„ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ìƒì„±í•˜ê³  ì ìš©í•´ì•¼ í•œë‹¤.

index.htmlì„ ê·¸ëƒ¥ ì—´ì—ˆì„ ë•Œì™€ëŠ” í•´ìƒë„ë‚˜ í¬ê¸°ê°€ ì¢€ ë‹¬ë¼ì„œ ìˆ˜ì •ì´ í•„ìš”í•˜ë‹¤.

---

# 5. APIë¡œ CardInfo JSONìœ¼ë¡œ ë°›ì•„ì„œ DBì— ì €ì¥í•˜ê¸°

ë¨¼ì € JSONìœ¼ë¡œ ë°›ì•„ì™€ì„œ, íŒŒì‹±í•˜ëŠ” ê²ƒ ê¹Œì§€ í•´ë´¤ë‹¤. viewì— ì¶œë ¥í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í–ˆë‹¤.

Ryugiohproject_app/views.py

```python
import requests
from django.http import JsonResponse
from django.shortcuts import render
from .models import Card

# Main page view
def index(request):
    cards = Card.objects.all()
    return render(request, 'index.html', {'cards': cards})

# API data fetching view
def cardinfo(request):
    url = 'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Yugi'
    response = requests.get(url)
    if response.status_code == 200:
        data = response.json()
        if 'data' in data:
            cards = data['data']
            filtered_cards = []
            for card in cards:
                filtered_card = {
                    'id': card.get('id'),
                    'name': card.get('name'),
                    'type': card.get('type'),
                    'frameType': card.get('frameType'),
                    'desc': card.get('desc'),
                    'atk': card.get('atk'),
                    'def': card.get('def'),
                    'level': card.get('level'),
                    'race': card.get('race'),
                    'attribute': card.get('attribute'),
                    'card_images': card.get('card_images'),
                    'card_prices': card.get('card_prices'),
                }
                filtered_cards.append(filtered_card)
            return JsonResponse(filtered_cards, safe=False)
        else:
            return JsonResponse({'error': 'Invalid data format'}, status=500)
    else:
        return JsonResponse({'error': 'Failed to retrieve data'}, status=response.status_code)

```

íŒŒì´ì¬ì—ì„œëŠ” requestë¥¼ ì‚¬ìš©í•˜ì—¬ HTTP ìš”ì²­ì„ ë³´ë‚´ê³ , ì‘ë‹µì„ ë°›ì•„ì˜¬ ìˆ˜ ìˆë‹¤. íŒŒì‹± ë˜í•œ ìƒë‹¹íˆ ì‰½ë‹¤.

Ryugiohproject_app/views.pyë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì„¸íŒ…í•˜ì—¬ ìœ„ì˜ ì½”ë“œì˜ ì‹¤í–‰ì„ ë³¼ ìˆ˜ ìˆë‹¤.

```python
from django.urls import path
from . import views

urlpatterns = [
    path('', views.index, name='index'),
    path('cardinfo/', views.cardinfo, name='cardinfo'),
]

```

## DB ìŠ¤í‚¤ë§ˆ ì •ì˜

Djangoì˜ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œìŠ¤í…œì€ ëª¨ë¸ ë³€ê²½ ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆì— ë°˜ì˜í•˜ëŠ” ë„êµ¬ì´ë‹¤. ëª¨ë¸ì„ ì •ì˜í•˜ê³  ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ìƒì„± ë° ì ìš©í•˜ë©´, ë°ì´í„°ë² ì´ìŠ¤ì— í•´ë‹¹í•˜ëŠ” í…Œì´ë¸”ì´ ìë™ìœ¼ë¡œ ìƒì„±ëœë‹¤.

models.py

```python
from django.db import models

# Create your models here.

class Card(models.Model):
    name = models.CharField(max_length=100)
    type = models.CharField(max_length=100, default='Normal')  # ê¸°ë³¸ê°’ ì¶”ê°€
    frameType = models.CharField(max_length=100, null=True, blank=True)
    desc = models.TextField()
    atk = models.IntegerField(null=True, blank=True)
    defense = models.IntegerField(null=True, blank=True)  # 'def' ëŒ€ì‹  'defense' ì‚¬ìš©
    level = models.IntegerField(null=True, blank=True)
    race = models.CharField(max_length=100, default='Dragon')  # ê¸°ë³¸ê°’ ì¶”ê°€
    attribute = models.CharField(max_length=100, null=True, blank=True)
    card_images = models.JSONField(null=True, blank=True)
    card_prices = models.JSONField(null=True, blank=True)

    def __str__(self):
        return self.name

```

ì´ë ‡ê²Œ ëª¨ë¸ì„ ì •ì˜í•œ í›„ makemigrations ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì„ ìƒì„±í•  ìˆ˜ ìˆë‹¤.

```python
python manage.py makemigrations
```

ìƒì„±ëœ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì„ ì ìš©í•˜ë©´ ë°ì´í„° ë² ì´ìŠ¤ì— ëª¨ë¸ì˜ ë³€ê²½ ì‚¬í•­ì´ ë°˜ì˜ëœë‹¤. ì¦‰, `Card` ëª¨ë¸ì— ëŒ€ì‘í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì´ ìë™ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ê²ƒì´ë‹¤.

```python
python manage.py migrate
```

## APIë¡œ ë°›ì€ JSON ë°ì´í„°ë¥¼ DBì— ì €ì¥í•˜ê¸°

views.py

```python
import requests
from django.http import JsonResponse
from django.shortcuts import render
from .models import Card
from django.db import transaction

# Main page view
def index(request):
    cards = Card.objects.all()
    return render(request, 'index.html', {'cards': cards})

def cardinfo(request):
    url = 'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Yugi'
    response = requests.get(url)
    if response.status_code == 200:
        data = response.json()
        if 'data' in data:
            cards = data['data']
            with transaction.atomic():
                for card in cards:
                    Card.objects.update_or_create(
                        id=card.get('id'),
                        defaults={
                            'name': card.get('name'),
                            'type': card.get('type'),
                            'frameType': card.get('frameType'),
                            'desc': card.get('desc'),
                            'atk': card.get('atk'),
                            'defense': card.get('def'),
                            'level': card.get('level'),
                            'race': card.get('race'),
                            'attribute': card.get('attribute'),
                            'card_images': card.get('card_images'),
                            'card_prices': card.get('card_prices'),
                        }
                    )
            return JsonResponse({'message': 'Data successfully saved to database'}, status=200)
        else:
            return JsonResponse({'error': 'Invalid data format'}, status=500)
    else:
        return JsonResponse({'error': 'Failed to retrieve data'}, status=response.status_code)

```

ì½”ë“œë¥¼ í•˜ë‚˜ì”© ëœ¯ì–´ë³´ì.

```python
def cardinfo(request):
    url = 'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Yugi'
    response = requests.get(url)
    if response.status_code == 200:
        data = response.json()
```

- ì™¸ë¶€ APIì— GET ìš”ì²­ì„ ë³´ë‚´ì„œ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µì„ íŒŒì‹±í•œë‹¤.

```python
    if 'data' in data:
        cards = data['data']
        with transaction.atomic():

```

- `transaction.atomic()` ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ íŠ¸ë™ì­ì…˜ì„ ì‹œì‘í•œë‹¤. ì´ë ‡ê²Œ í•˜ë©´ DBì˜ ì‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì§€ ì•Šìœ¼ë©´ ëª¨ë“  ì‘ì—…ì´ ë¡¤ë°±ëœë‹¤.

```python
                for card in cards:
                    Card.objects.update_or_create(
                        id=card.get('id'),
                        defaults={
                            'name': card.get('name'),
                            'type': card.get('type'),
                            'frameType': card.get('frameType'),
                            'desc': card.get('desc'),
                            'atk': card.get('atk'),
                            'defense': card.get('def'),  # JSON ë°ì´í„°ì˜ 'def' í•„ë“œë¥¼ 'defense' í•„ë“œë¡œ ë§¤í•‘
                            'level': card.get('level'),
                            'race': card.get('race'),
                            'attribute': card.get('attribute'),
                            'card_images': card.get('card_images'),
                            'card_prices': card.get('card_prices'),
                        }
                    )

```

- `Card.objects.undate_or_create` : ì²« ë²ˆì§¸ íŒŒë¼ë¯¸í„°ë¥¼ primaryKeyë¡œ í•˜ì—¬ Cardë¥¼ ëª¨ë¸ë¡œ ì‚¬ìš©í•˜ëŠ” Databaseì— ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸í•˜ê±°ë‚˜ ìƒˆë¡œìš´ ë ˆì½”ë“œë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.

ì´ë ‡ê²Œ DB ìƒì„± ë° ë°ì´í„° ì‚½ì…ì„ ë§ˆì³¤ë‹¤.

ğŸ’¡ ì°¸ê³ ) ìƒì„±ëœ DBì˜ í™•ì¸ì€ admin ê³„ì •ì„ ìƒì„±í•˜ê³ , admin urlë¡œ ì ‘ì†í•˜ì—¬ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![alt text](image-3.png)

ê·¸ëŸ°ë° views.pyì—ì„œ DBì˜ ì‚½ì…ì´ ì´ë£¨ì–´ ì§€ëŠ” ê²ƒì€ ì˜³ì§€ ì•Šë‹¤. ì¬ì‚¬ìš©ì„± ì¸¡ë©´ê³¼ SRP ì›ì¹™, ìœ ì§€ ë³´ìˆ˜ì˜ ì¸¡ë©´ì—ì„œ DBì™€ ê´€ë ¨ëœ ì‘ì—…ì€ ì„œë¹„ìŠ¤ ê³„ì¸µì—ì„œ ì´ë£¨ì–´ì§€ëŠ” í¸ì´ ì¢‹ì•„ë³´ì¸ë‹¤. ë”°ë¼ì„œ `services.py` ë¥¼ ì •ì˜í•˜ê³ , í•´ë‹¹ íŒŒì¼ì—ì„œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë¦¬íŒ©í† ë§í–ˆë‹¤.

services.py

```python
# Ryugiohproject_app/services.py

import requests
from .models import Card
from django.db import transaction

class CardService:

    @staticmethod
    def fetch_and_save_card_data():
        url = 'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Yugi'
        response = requests.get(url)
        if response.status_code == 200:
            data = response.json()
            if 'data' in data:
                cards = data['data']
                with transaction.atomic():
                    for card in cards:
                        Card.objects.update_or_create(
                            id=card.get('id'),
                            defaults={
                                'name': card.get('name'),
                                'type': card.get('type'),
                                'frameType': card.get('frameType'),
                                'desc': card.get('desc'),
                                'atk': card.get('atk'),
                                'defense': card.get('def'),
                                'level': card.get('level'),
                                'race': card.get('race'),
                                'attribute': card.get('attribute'),
                                'card_images': card.get('card_images'),
                                'card_prices': card.get('card_prices'),
                            }
                        )
                return {'message': 'Data successfully saved to database'}
            else:
                return {'error': 'Invalid data format'}
        else:
            return {'error': f'Failed to retrieve data: {response.status_code}'}

```

ê·¸ë¦¬ê³  `CardService.fetch_and_save_card_data()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì„œ DBì— ë°ì´í„°ë¥¼ ë°›ì•„ì˜¬ ìˆ˜ ìˆë‹¤.

---

# 6. DB ì±„ìš°ê¸° ë° ì¤‘ë³µ ì œê±°

```python
# Ryugiohproject_app/services.py

import requests
from .models import Card
from django.db import transaction

class CardService:

    @staticmethod
    def fetch_and_save_card_data():
        urls = [
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Yugi',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Kaiba',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Joey',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Pegasus',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Obelisk%20the%20Tormentor',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Slifer%20the%20Sky%20Dragon',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=The%20Winged%20Dragon%20of%20Ra',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Exodia%20the%20Forbidden%20One',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Left%20Arm%20of%20the%20Forbidden%20One',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Left%20Leg%20of%20the%20Forbidden%20One',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Right%20Leg%20of%20the%20Forbidden%20One',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Blue-Eyes%20Ultimate%20Dragon',
        ]

        all_cards = []

        # Fetch data from all URLs
        for url in urls:
            response = requests.get(url)
            if response.status_code == 200:
                data = response.json()
                if 'data' in data:
                    all_cards.extend(data['data'])
                else:
                    return {'error': f'Invalid data format from {url}'}
            else:
                return {'error': f'Failed to retrieve data from {url}: {response.status_code}'}

        # Save all card data to the database
        with transaction.atomic():
            for card in all_cards:
                Card.objects.update_or_create(
                    id=card.get('id'),
                    defaults={
                        'name': card.get('name'),
                        'type': card.get('type'),
                        'frameType': card.get('frameType'),
                        'desc': card.get('desc'),
                        'atk': card.get('atk'),
                        'defense': card.get('def'),
                        'level': card.get('level'),
                        'race': card.get('race'),
                        'attribute': card.get('attribute'),
                        'card_images': card.get('card_images'),
                        'card_prices': card.get('card_prices'),
                    }
                )

        return {'message': 'Data successfully saved to database'}

```

ì´ë ‡ê²Œ ê° ìŠ¤íƒ€í„° ë±ê³¼ ê¶ê·¹ì˜ í‘¸ë¥¸ ëˆˆì˜ ë°±ë£¡ ì—‘ì¡°ë””ì•„, ì‚¼í™˜ì‹ ì„ DBì— ì¶”ê°€í–ˆë‹¤.

í›„ìì˜ ì„¸ ì¹´ë“œë¥¼ ë”°ë¡œ ì¶”ê°€í•œ ì´ìœ ëŠ” ë©”ì¸ í˜ì´ì§€ì—ì„œ ì´ ì¹´ë“œë“¤ì„ ë³´ì—¬ì£¼ê³  ë©”ë‰´ ë°”ë¥¼ í†µí•´ ìŠ¤íƒ€í„° ë±ì„ ë³´ê¸° ìœ„í•¨ì´ë‹¤.

êµ¬í˜„ ë¶€ë¶„ì—ì„œëŠ” ê¸°ì¡´ê³¼ ê±°ì˜ ë˜‘ê°™ì€ë° url, responseê°€ êµ‰ì¥íˆ ë§ì•„ì§„ë§Œí¼ ë¦¬ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•´ì„œ ë¦¬íŒ©í† ë§í–ˆë‹¤.

ë¬¸ì œì ì„ ì°¾ì•˜ëŠ”ë°, í˜„ì¬ ë°©ì‹ì€ `/cardinfo` urlë¡œ ì ‘ê·¼í•  ë•Œ ë§ˆë‹¤ DBì— API ë°ì´í„°ë¥¼ ì¤‘ë³µí•´ì„œ ì¶”ê°€í•œë‹¤. apiê°€ ë” ì´ìƒ ì—…ë°ì´íŠ¸ ë˜ì§€ë„ ì•Šê³  ë”°ë¡œ ê´€ë¦¬ì í˜ì´ì§€ë¥¼ ë§Œë“¤ì§€ ì•Šì„ ì˜ˆì •ì´ë¼ í•´ë‹¹ ë°©ì‹ì´ ì•„ë‹Œ ê´€ë¦¬ ì»¤ë§¨ë“œë¡œ DBë¥¼ ì´ˆê¸°í™”í•œ ë’¤ API ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½í–ˆë‹¤.

```python
# Ryugiohproject_app/management/commands/load_cards.py

from django.core.management.base import BaseCommand
from Ryugiohproject_app.services import CardService
from Ryugiohproject_app.models import Card

class Command(BaseCommand):
    help = 'Load cards from external API and save to database'

    def handle(self, *args, **kwargs):
        # ê¸°ì¡´ ë°ì´í„°ë¥¼ ì‚­ì œ
        self.stdout.write('Deleting existing card data...')
        Card.objects.all().delete()

        # ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì„œ ì €ì¥
        result = CardService.fetch_and_save_card_data()
        if 'message' in result:
            self.stdout.write(self.style.SUCCESS(result['message']))
        else:
            self.stdout.write(self.style.ERROR(result['error']))

```

ìœ„ì˜ ë°©ì‹ìœ¼ë¡œ ê´€ë¦¬ ì»¤ë§¨ë“œë¥¼ ìƒì„±í•  ìˆ˜ ìˆê³ , `python manage.py load_cards` ì´ë ‡ê²Œ ê´€ë¦¬ ì»¤ë§¨ë“œë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.

ì´ì œ êµ¬í˜„í•  ì‚¬í•­ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

1. ìŠ¤íƒ€í„° ë±ì„ ê¸°ì¤€ìœ¼ë¡œ apië¥¼ ë°›ì•„ì˜¤ë‹¤ ë³´ë‹ˆ, ì¤‘ë³µëœ ì¹´ë“œë“¤ì´ ë§ë‹¤. ì¤‘ë³µëœ ì¹´ë“œë¥¼ ì œê±°í•´ì•¼ í•œë‹¤.
2. í˜„ì¬ ì´ë¯¸ì§€ê°€ DBì— ì €ì¥ë˜ëŠ” ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

   ```python
   {
     "id": 23995346,
     "image_url": "https://images.ygoprodeck.com/images/cards/23995346.jpg",
     "image_url_small": "https://images.ygoprodeck.com/images/cards_small/23995346.jpg",
     "image_url_cropped": "https://images.ygoprodeck.com/images/cards_cropped/23995346.jpg"
   },
   {
     "id": 23995347,
     "image_url": "https://images.ygoprodeck.com/images/cards/23995347.jpg",
     "image_url_small": "https://images.ygoprodeck.com/images/cards_small/23995347.jpg",
     "image_url_cropped": "https://images.ygoprodeck.com/images/cards_cropped/23995347.jpg"
   },
   {
     "id": 23995348,
     "image_url": "https://images.ygoprodeck.com/images/cards/23995348.jpg",
     "image_url_small": "https://images.ygoprodeck.com/images/cards_small/23995348.jpg",
     "image_url_cropped": "https://images.ygoprodeck.com/images/cards_cropped/23995348.jpg"
   }
   ```

   ê±°ì˜ ëª¨ë“  ì—”í‹°í‹°ê°€ ì´ë¯¸ì§€ ì†ŒìŠ¤ê°€ ì—¬ëŸ¬ê°œ ì¡´ì¬í•´ì„œ ì´ ë¶€ë¶„ ì²˜ë¦¬ê°€ í•„ìš”í•˜ë‹¤.

   **ì¦‰, ì´ë¯¸ì§€ ì†ŒìŠ¤ í•˜ë‚˜ë¥¼ ì„ íƒí•´ì„œ ì¶œë ¥ì„ í•˜ë˜, ë¡œì»¬ì— ì €ì¥ì„ í•˜ë˜, ë°©ì‹ì„ ê³ ë¯¼í•˜ê³  êµ¬í˜„í•´ì•¼ í•œë‹¤.**

3. ë©”ì¸ í˜ì´ì§€ì—ì„œ ì—‘ì¡°ë””ì•„ 5ì¢…ë¥˜, ê¶ê·¹ì˜ í‘¸ë¥¸ ëˆˆì˜ ë°±ë£¡, ì‚¼í™˜ì‹ ì„ ë³´ì—¬ì¤˜ì•¼ í•œë‹¤. í•´ë‹¹ ë¶€ë¶„ì„ jsonìœ¼ë¡œ í”„ë¡ íŠ¸ì—ì„œ ë³´ì—¬ì¤˜ì•¼ í•˜ê¸°ì— ì…€ë ‰íŠ¸ë¬¸ê³¼ index.htmlì— jsonìœ¼ë¡œ ë„˜ê²¨ì£¼ëŠ” ë°©ì‹ì„ êµ¬í˜„í•´ì•¼ í•œë‹¤.
4. ìŠ¤íƒ€í„° ë±ì„ ë³´ì—¬ì£¼ë ¤ë©´ ë¯¸ë¦¬ ìœ í¬ì˜ ìŠ¤íƒ€ë” ë± id listë¥¼ ì •ì˜í•´ë†“ë˜ê°€(í•˜ë“œì½”ë”©), apiì˜ card_setì„ ì‚¬ìš©í•˜ë˜ê°€ í•´ì•¼í•œë‹¤. ì´ ë¶€ë¶„ë„ ê³ ë¯¼ì´ í•„ìš”í•˜ë‹¤.
5. ë·°ì—ì„œ ë©”ë‰´ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ ë‹¤ë¥¸ í™”ë©´ìœ¼ë¡œ ë„˜ì–´ê°€ëŠ” url ë§¤í•‘ ë°©ì‹ê³¼ urlì„ ê³ ë¯¼í•´ì•¼ í•œë‹¤. ì•„ë§ˆ GET ì¿¼ë¦¬ë¬¸ìœ¼ë¡œ ì‘ì„±í•  ê²ƒ ê°™ë‹¤.
6. íšŒì› ê°€ì…, ë¡œê·¸ì¸, ë§ˆì´ í˜ì´ì§€, ì¢‹ì•„ìš” ê¸°ëŠ¥ì„ êµ¬í˜„í•´ì•¼ í•œë‹¤.

## ì¤‘ë³µ ì œê±°í•˜ê¸°

ì¹´ë“œì˜ ì¤‘ë³µì„ ì œê±°í•˜ëŠ” ë°©ë²•ì€ í¬ê²Œ 2ê°€ì§€ê°€ ë– ì˜¤ë¥¸ë‹¤.

1. ì‚½ì… ì‹œ ê²€ìƒ‰ì„ í†µí•´ ì‚­ì œí•˜ê¸°
   - ê²€ìƒ‰ì´ ì–´ë–»ê²Œ ì´ë£¨ì–´ì§€ëŠ”ì§€ ëª¨ë¥´ê² ì§€ë§Œ O(n)ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆë”ë¼ë„ O(n^2)ì´ ë“ ë‹¤. â†’ ê¸°ê°
2. ì •ë ¬ í›„ ì‚­ì œí•˜ê¸°
   - ì‹œê°„ ë³µì¡ë„ëŠ” ì •ë ¬ì— O(nlog n), ì‚­ì œì— O(n)ì´ë¯€ë¡œ O(nlog n)ì´ë‹¤. ê·¸ë¦¬ê³  ë°ì´í„°ë¥¼ ì •ë ¬í•´ë„ ìƒê´€ ì—†ìœ¼ë¯€ë¡œ ì´ë ‡ê²Œ êµ¬í˜„í•˜ì˜€ë‹¤.

```python
import requests
from .models import Card
from django.db import transaction
import logging

logger = logging.getLogger(__name__)

class CardService:

    @staticmethod
    def fetch_and_save_card_data():
        urls = [
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Yugi',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Kaiba',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Joey',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Pegasus',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Obelisk%20the%20Tormentor',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Slifer%20the%20Sky%20Dragon',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=The%20Winged%20Dragon%20of%20Ra',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Exodia%20the%20Forbidden%20One',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Left%20Arm%20of%20the%20Forbidden%20One',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Left%20Leg%20of%20the%20Forbidden%20One',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Right%20Leg%20of%20the%20Forbidden%20One',
        ]

        all_cards = []

        # Fetch data from all URLs
        for url in urls:
            response = requests.get(url)
            if response.status_code == 200:
                data = response.json()
                if 'data' in data:
                    all_cards.extend(data['data'])
                else:
                    error_message = f'Invalid data format from {url}'
                    logger.error(error_message)
                    return {'error': error_message}
            else:
                error_message = f'Failed to retrieve data from {url}: {response.status_code}'
                logger.error(error_message)
                return {'error': error_message}

        # Sort the cards by id and remove duplicates
        all_cards.sort(key=lambda card: card['id'])
        unique_cards = []
        last_id = None
        for card in all_cards:
            if card['id'] != last_id:
                unique_cards.append(card)
                last_id = card['id']

        # Save all unique card data to the database
        try:
            with transaction.atomic():
                for card in unique_cards:
                    Card.objects.update_or_create(
                        id=card.get('id'),
                        defaults={
                            'name': card.get('name'),
                            'type': card.get('type'),
                            'frameType': card.get('frameType'),
                            'desc': card.get('desc'),
                            'atk': card.get('atk'),
                            'defense': card.get('def'),
                            'level': card.get('level'),
                            'race': card.get('race'),
                            'attribute': card.get('attribute'),
                            'card_images': card.get('card_images'),
                            'card_prices': card.get('card_prices'),
                        }
                    )
            return {'message': 'Data successfully saved to database'}
        except Exception as e:
            logger.error(f'Error saving data to the database: {e}')
            return {'error': 'Error saving data to the database'}

```

í•µì‹¬ ë¡œì§ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

```python
 all_cards.sort(key=lambda card: card['id'])
        unique_cards = []
        last_id = None
        for card in all_cards:
            if card['id'] != last_id:
                unique_cards.append(card)
                last_id = card['id']
```

idë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ê³ , last_idë¥¼ ì‚¬ìš©í•´ì„œ ì‚­ì œí•˜ëŠ” ë°©ì‹ì´ë‹¤.

---

# 7. ì´ë¯¸ì§€ URL íŒŒì‹±

ìœ„ì—ì„œ ë§í•œ ë¬¸ì œ ì¤‘ ì´ë¯¸ì§€ ì—¬ëŸ¬ ê°œê°€ API ë°ì´í„°ë¡œ ì‚½ì…ë˜ì–´ ìˆëŠ” ë¬¸ì œë¥¼ í•´ê²°í–ˆë‹¤. ì—¬ëŸ¬ urlë“¤ì„ ë¶„ì„í•´ë³´ë‹ˆ í° ì°¨ì´ê°€ ì—†ì–´ì„œ ê·¸ëƒ¥ ê°€ì¥ ì²˜ìŒ ë‚˜ì˜¤ëŠ” ë°ì´í„°ë¥¼ DBì— ì‚½ì…í–ˆë‹¤.

```python
import requests
from .models import Card
from django.db import transaction
import logging

logger = logging.getLogger(__name__)

class CardService:

    @staticmethod
    def fetch_and_save_card_data():
        urls = [
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Yugi',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Kaiba',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Joey',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Pegasus',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Obelisk%20the%20Tormentor',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Slifer%20the%20Sky%20Dragon',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=The%20Winged%20Dragon%20of%20Ra',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Exodia%20the%20Forbidden%20One',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Left%20Arm%20of%20the%20Forbidden%20One',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Left%20Leg%20of%20the%20Forbidden%20One',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Right%20Leg%20of%20the%20Forbidden%20One',
        ]

        all_cards = []

        # Fetch data from all URLs
        for url in urls:
            response = requests.get(url)
            if response.status_code == 200:
                data = response.json()
                if 'data' in data:
                    all_cards.extend(data['data'])
                else:
                    error_message = f'Invalid data format from {url}'
                    logger.error(error_message)
                    return {'error': error_message}
            else:
                error_message = f'Failed to retrieve data from {url}: {response.status_code}'
                logger.error(error_message)
                return {'error': error_message}

        # Sort the cards by id and remove duplicates
        all_cards.sort(key=lambda card: card['id'])
        unique_cards = []
        last_id = None
        for card in all_cards:
            if card['id'] != last_id:
                unique_cards.append(card)
                last_id = card['id']

        # Save all unique card data to the database
        try:
            with transaction.atomic():
                for card in unique_cards:
                    # Get the first image URL
                    image_url = card['card_images'][0]['image_url'] if card['card_images'] else None

                    Card.objects.update_or_create(
                        id=card.get('id'),
                        defaults={
                            'name': card.get('name'),
                            'type': card.get('type'),
                            'frameType': card.get('frameType'),
                            'desc': card.get('desc'),
                            'atk': card.get('atk'),
                            'defense': card.get('def'),
                            'level': card.get('level'),
                            'race': card.get('race'),
                            'attribute': card.get('attribute'),
                            'card_images': image_url,
                            'card_prices': card.get('card_prices'),
                        }
                    )
            return {'message': 'Data successfully saved to database'}
        except Exception as e:
            logger.error(f'Error saving data to the database: {e}')
            return {'error': 'Error saving data to the database'}

```

## ë·°ë¡œ ë°ì´í„° ë„˜ê²¨ì£¼ê¸°

ì´ë²ˆì— êµ¬í˜„í•  ë¶€ë¶„ì€ `http://127.0.0.1:8000/` ë¡œ ì ‘ì†í•˜ë©´ ì›°ì»´í˜ì´ì§€ê°€ ë‚˜ì˜¤ë©´ì„œ ê±°ê¸°ì„œ ì‚¼í™˜ì‹ ê³¼ ì—‘ì¡°ë””ì•„ ì‹œë¦¬ì¦ˆ, ê¶ê·¹ì˜ í‘¸ë¥¸ëˆˆì˜ ë°±ë£¡ ì¹´ë“œë¥¼ ì¶œë ¥í•˜ëŠ” ë¶€ë¶„ì´ë‹¤.

ìˆœìˆ˜ JSì—ì„œ ë°ì´í„°ë¥¼ ì¶œë ¥í•˜ëŠ” ë°©ì‹ì€ ì£¼ë¡œ JSONì„ ì‚¬ìš©í•œë‹¤ê³  í•œë‹¤. ë˜, JSì—ì„œ `http://127.0.0.1:8000/?ids=` ë¡œ ìš”ì²­ì„ ë³´ë‚´ê³ , ì‘ë‹µìœ¼ë¡œ í•´ë‹¹ ì¹´ë“œì˜ ë¦¬í„´ì„ ë°›ì•„ì„œ ì¶œë ¥í•  ìˆ˜ ìˆë‹¤. ìŠ¤í”„ë§ì„ ì‚¬ìš©í–ˆì„ ë•ŒëŠ” í”„ë¡ íŠ¸ë„ í…œí”Œë¦¿ ì—”ì§„ì„ ì¨ì„œ ì „í˜€ ë‹¤ë¥¸ ë°©ì‹ì´ì—ˆëŠ”ë° JSONìœ¼ë¡œ ë‹¤ë£¨ëŠ”ê±´ ì²˜ìŒì´ë‹¤.

## CardSet ì„¤ì •

```python
import requests
from .models import Card, CardSet
from django.db import transaction
import logging

logger = logging.getLogger(__name__)

class CardService:

    @staticmethod
    def fetch_and_save_card_data():
        urls = [
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Yugi',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Kaiba',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Joey',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?cardset=Starter%20Deck:%20Pegasus',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Obelisk%20the%20Tormentor',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Slifer%20the%20Sky%20Dragon',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=The%20Winged%20Dragon%20of%20Ra',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Exodia%20the%20Forbidden%20One',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Left%20Arm%20of%20the%20Forbidden%20One',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Left%20Leg%20of%20the%20Forbidden%20One',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Right%20Leg%20of%20the%20Forbidden%20One',
            'https://db.ygoprodeck.com/api/v7/cardinfo.php?name=Blue-Eyes%20Ultimate%20Dragon'
        ]

        all_cards = []

        # Fetch data from all URLs
        for url in urls:
            response = requests.get(url)
            if response.status_code == 200:
                data = response.json()
                if 'data' in data:
                    all_cards.extend(data['data'])
                else:
                    error_message = f'Invalid data format from {url}'
                    logger.error(error_message)
                    return {'error': error_message}
            else:
                error_message = f'Failed to retrieve data from {url}: {response.status_code}'
                logger.error(error_message)
                return {'error': error_message}

        # Sort the cards by id and remove duplicates
        all_cards.sort(key=lambda card: card['id'])
        unique_cards = []
        last_id = None
        for card in all_cards:
            if card['id'] != last_id:
                unique_cards.append(card)
                last_id = card['id']

        # Save all unique card data to the database
        try:
            with transaction.atomic():
                for card in unique_cards:
                    # Get the first image URL
                    image_url = card['card_images'][0]['image_url'] if card['card_images'] else None

                    # Create or update the card
                    card_obj, created = Card.objects.update_or_create(
                        id=card.get('id'),
                        defaults={
                            'name': card.get('name'),
                            'type': card.get('type'),
                            'frameType': card.get('frameType'),
                            'desc': card.get('desc'),
                            'atk': card.get('atk'),
                            'defense': card.get('def'),
                            'level': card.get('level'),
                            'race': card.get('race'),
                            'attribute': card.get('attribute'),
                            'card_images': image_url,
                            'card_prices': card.get('card_prices'),
                        }
                    )

                    # Check for specific set names in card_sets and create or update the sets
                    for card_set in card.get('card_sets', []):
                        if card_set['set_name'] in ['Starter Deck: Yugi', 'Starter Deck: Kaiba', 'Starter Deck: Joey', 'Starter Deck: Pegasus']:
                            set_obj, set_created = CardSet.objects.update_or_create(
                                set_name=card_set['set_name'],
                            )
                            card_obj.sets.add(set_obj)
            return {'message': 'Data successfully saved to database'}
        except Exception as e:
            logger.error(f'Error saving data to the database: {e}')
            return {'error': 'Error saving data to the database'}

```

```python
from django.db import models

class CardSet(models.Model):
    set_name = models.CharField(max_length=100)

    def __str__(self):
        return self.set_name

class Card(models.Model):
    name = models.CharField(max_length=100)
    type = models.CharField(max_length=100)
    frameType = models.CharField(max_length=100, null=True, blank=True)
    desc = models.TextField()
    atk = models.IntegerField(null=True, blank=True)
    defense = models.IntegerField(null=True, blank=True)
    level = models.IntegerField(null=True, blank=True)
    race = models.CharField(max_length=100)
    attribute = models.CharField(max_length=100, null=True, blank=True)
    card_images = models.URLField(null=True, blank=True)
    card_prices = models.JSONField(null=True, blank=True)
    sets = models.ManyToManyField(CardSet, related_name='cards')

    def __str__(self):
        return self.name

```

ìš°ì„  ì´ë ‡ê²Œ DBì— CardSet ì—”í‹°í‹°ë¥¼ ì¶”ê°€í•˜ê³  ìŠ¤íƒ€í„° ë±ì¸ ê²½ìš°ì—ë§Œ ì¶”ê°€í•˜ë„ë¡ ë³€ê²½í–ˆë‹¤.

---

# 8. GET Request & Response Body JSON

ì´ì œ ë‚¨ì€ êµ¬í˜„ ì‚¬í•­ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

1. ì´ë¯¸ì§€ ì†ŒìŠ¤ í•˜ë‚˜ë¥¼ ì„ íƒí•´ì„œ ì¶œë ¥ì„ í•˜ë˜, ë¡œì»¬ì— ì €ì¥ì„ í•˜ë˜, ë°©ì‹ì„ ê³ ë¯¼í•˜ê³  êµ¬í˜„í•´ì•¼ í•œë‹¤.
2. ë©”ì¸ í˜ì´ì§€ì—ì„œ ì—‘ì¡°ë””ì•„ 5ì¢…ë¥˜, ê¶ê·¹ì˜ í‘¸ë¥¸ ëˆˆì˜ ë°±ë£¡, ì‚¼í™˜ì‹  JSONìœ¼ë¡œ ë³´ë‚´ì£¼ê¸°
3. ìºë¦­í„°ë³„ í˜ì´ì§€ì—ì„œ ë³¼ ìˆ˜ ìˆê²Œ card_set ê¸°ì¤€ìœ¼ë¡œ selectí•´ì„œ JSONìœ¼ë¡œ ë³´ë‚´ì£¼ê¸°
4. ëª¨ë“  ì¹´ë“œ ë³´ê¸° JSONìœ¼ë¡œ ë³´ë‚´ì£¼ê¸°
5. ë·°ì—ì„œ ë©”ë‰´ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ ë‹¤ë¥¸ í™”ë©´ìœ¼ë¡œ ë„˜ì–´ê°€ëŠ” url ë§¤í•‘ ë°©ì‹ê³¼ urlì„ ê³ ë¯¼í•´ì•¼ í•œë‹¤. ì•„ë§ˆ GET ì¿¼ë¦¬ë¬¸ìœ¼ë¡œ ì‘ì„±í•  ê²ƒ ê°™ë‹¤.

### ë©”ì¸ í˜ì´ì§€

ìš°ì„  ë©”ì¸ í˜ì´ì§€ë¶€í„° ì™„ì„±í•˜ì! ê·¸ëŸ¼ ë©”ì¸ í˜ì´ì§€ì—ì„œ ì—‘ì¡°ë””ì•„ 5ì¢…ë¥˜, ê¶ê·¹ì˜ í‘¸ë¥¸ ëˆˆì˜ ë°±ë£¡, ì‚¼í™˜ì‹  JSONìœ¼ë¡œ ë³´ë‚´ì£¼ê¸°ë¥¼ êµ¬í˜„í•˜ë©´ ëœë‹¤.

ì—‘ì¡°ë””ì•„ì™€ ê¶ê·¹ì˜ í‘¸ë¥¸ ëˆˆì˜ ë°±ë£¡, ì‚¼í™˜ì‹ ì˜ card idëŠ” 10000000, 10000010, 10000020, 33396948, 7902349, 44519536, 23995346, 8124921 ì´ë ‡ê²Œ ëœë‹¤.

ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ `views.py` ì— `main_cards` ë©”ì„œë“œë¥¼ ì •ì˜í•˜ê³  `index.html` ì—ì„œ `api/main-cards/` ê²½ë¡œë¡œ ìš”ì²­ì„ ë³´ë‚´ë©´ `mian_cards`ê°€ ì‹¤í–‰ë˜ì–´ì„œ ì‘ë‹µ ë©”ì‹œì§€ ë°”ë””ë¡œ JSONì„ ë°›ê²Œë” êµ¬í˜„í•˜ì˜€ë‹¤.

```python
# Ryugiohproject_app/views.py

from django.http import JsonResponse
from django.shortcuts import render
from .models import Card

# Main page view
def index(request):
    return render(request, 'index.html')

# View to get specific card details
def main_cards(request):
    card_ids = [10000000, 10000010, 10000020, 33396948, 7902349, 44519536, 23995346, 8124921]
    cards = Card.objects.filter(id__in=card_ids)
    card_data = [{
        'id': card.id,
        'name': card.name,
        'type': card.type,
        'frameType': card.frameType,
        'desc': card.desc,
        'atk': card.atk,
        'defense': card.defense,
        'level': card.level,
        'race': card.race,
        'attribute': card.attribute,
        'card_images': card.card_images,
        'card_prices': card.card_prices,
    } for card in cards]
    return JsonResponse(card_data, safe=False)

```

```python
from django.urls import path
from . import views

urlpatterns = [
    path('', views.index, name='index'),
    path('api/main-cards/', views.main_cards, name='main_cards'),
]
```

ì‚¬ìš© ì˜ˆì‹œ

```html
<script>
  document.addEventListener("DOMContentLoaded", function () {
    fetchCardDetails();

    function fetchCardDetails() {
      fetch("/api/main-cards/")
        .then((response) => response.json())
        .then((data) => {
          const cardInfoDiv = document.getElementById("card-info");
          cardInfoDiv.innerHTML = data
            .map(
              (card) => `
                        <div class="card">
                            <h2>${card.name}</h2>
                            <img src="${card.card_images}" alt="${card.name}">
                            <p>Type: ${card.type}</p>
                            <p>Description: ${card.desc}</p>
                            <p>ATK: ${card.atk}</p>
                            <p>DEF: ${card.defense}</p>
                        </div>
                    `
            )
            .join("");
        })
        .catch((error) => console.error("Error fetching card details:", error));
    }
  });
</script>
```

`/api/main-cards/` ë¡œ ìš”ì²­ì„ ë³´ë‚´ê³  JSON ì‘ë‹µì„ íŒŒì‹±í•˜ëŠ”ê²Œ í•µì‹¬ì´ë‹¤.

---

### ëª¨ë“  ì¹´ë“œ ë³´ê¸°

ëª¨ë“  ì¹´ë“œë¥¼ responseì— JSONìœ¼ë¡œ ë³´ë‚´ëŠ” í•¨ìˆ˜ ì‘ì„±

```html
# View to get all card details def all_cards(request): cards =
Card.objects.all() card_data = [{ 'id': card.id, 'name': card.name, 'type':
card.type, 'frameType': card.frameType, 'desc': card.desc, 'atk': card.atk,
'defense': card.defense, 'level': card.level, 'race': card.race, 'attribute':
card.attribute, 'card_images': card.card_images, 'card_prices':
card.card_prices, } for card in cards] return JsonResponse(card_data,
safe=False)
```

url ë§¤í•‘ ì™„ë£Œ

```html
# Ryugiohproject_app/urls.py from django.urls import path from . import views
urlpatterns = [ path('', views.index, name='index'), path('api/main-cards/',
views.main_cards, name='main_cards'), path('api/all-cards/', views.all_cards,
name='all_cards'), ]
```

ì‚¬ìš© ì˜ˆì‹œ

```html
<script>
  document.addEventListener("DOMContentLoaded", function () {
    fetchCardDetails();

    function fetchCardDetails() {
      fetch("/api/all-cards/")
        .then((response) => response.json())
        .then((data) => {
          const cardInfoDiv = document.getElementById("card-info");
          cardInfoDiv.innerHTML = data
            .map(
              (card) => `
                        <div class="card">
                            <h2>${card.name}</h2>
                            <img src="${card.card_images}" alt="${card.name}">
                            <p>Type: ${card.type}</p>
                            <p>Description: ${card.desc}</p>
                            <p>ATK: ${card.atk}</p>
                            <p>DEF: ${card.defense}</p>
                        </div>
                    `
            )
            .join("");
        })
        .catch((error) => console.error("Error fetching card details:", error));
    }
  });
</script>
```

---

# 9. ì¥ê³  í…œí”Œë¦¿ ì—”ì§„ì„ ì´ìš©í•œ ì¹´ë“œ ëª¨ë¸ ì¶œë ¥

ê¸°ì¡´ JSONìœ¼ë¡œ ë°˜í™˜í•˜ëŠ” ë°©ì‹ì€ `innterHTML` ì„ ì‚¬ìš©í•´ì•¼ í•´ì„œ ì œì•½ì‚¬í•­ë„ êµ‰ì¥íˆ ë§ê³  ë”ëŸ¬ìš´ êµ¬í˜„ë²•ì´ì—ˆë‹¤. ì‹¹ ë‹¤ ëœ¯ì–´ ê³ ì³ì„œ ì¥ê³  í…œí”Œë¦¿ ì—”ì§„ì„ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½í–ˆë‹¤.

<ì½”ë“œ ìƒëµ>

---

# 10. ëŠë‚€ì 

í…œí”Œë¦¿ ì—”ì§„ ì‚¬ìš©ë²•ê³¼ í”„ë¡ íŠ¸, ë°±ì˜ ê¸°ë³¸ ê°œë…ì´ ë‹¤ì ¸ì¡Œë‹¤. ìƒê°í•˜ì§€ ëª»í•œ ì´ë“ì´ì—ˆë‹¤. ì‚¬ì‹¤ ë­ ì‚¬ìš©ë²•ê³¼ ê°œë…ì€ ê³µë¶€í•˜ë©´ ë˜ëŠ”ê±°ê³  ì§„ì§œ ëŠë‚€ ì ì€ ê·¼ê±°ìˆëŠ” ë””ë²„ê¹…ì˜ ì¤‘ìš”ì„±ì´ì—ˆë‹¤.

ë‚´ê°€ í’€ìŠ¤íƒì„ ë„ì™€ê°€ë©´ì„œ í•˜ë‹¤ë³´ë‹ˆ ë°±ì—ì„œ ì¼ì–´ë‚˜ëŠ” ì˜¤ë¥˜ëŠ” ë¡œê·¸ë¡œ, í”„ë¡ íŠ¸ì—ì„œë„ ë¡œê·¸ë¡œ í•´ê²°í•˜ë ¤ í–ˆë‹¤. ê·¸ëŸ°ë° ê·œëª¨ê°€ ì»¤ì§€ë‹¤ë³´ë‹ˆ ë¡œê·¸ê°€ ì–´ë–»ê²Œ ì°íˆëŠ”ì§€ë„ ëª¨ë¥´ê² ê³  ë§ì€ ì˜¤ë¥˜ë¥¼ ê²ªì–´ì„œ ì°¨ê·¼ ì°¨ê·¼ ì¸í„°ë„· ë„êµ¬ì˜ ë„¤íŠ¸ì›Œí¬ íƒ­ê³¼ ì†ŒìŠ¤ íƒ­ì„ í™•ì¸í•˜ê³ , ë¡œê·¸ë¥¼ ì°ì–´ë³´ê³ , ë…¼ë¦¬ì ìœ¼ë¡œ íŒë‹¨í•˜ì—¬ ì´ ë¶€ë¶„ì€ ë¬¸ì œê°€ ì—†ë‹¤. í˜¹ì€ ì´ ë¶€ë¶„ì— ë¬´ì¡°ê±´ ë¬¸ì œê°€ ìˆë‹¤. ì´ëŸ°ê±¸ ì˜ íŒë‹¨í•˜ëŠ” ëŠ¥ë ¥ì´ ê¸¸ëŸ¬ì¡Œë‹¤.

ë˜ ê¹ƒì„ ê·¸ë‚˜ë§ˆ ì²´ê³„ì ìœ¼ë¡œ ì‚¬ìš©í•˜ë©´ì„œ ì›ê²© ì €ì¥ì†Œ, ì›ë³¸ ì €ì¥ì†Œ, ë¡œì»¬ ì €ì¥ì†Œì˜ ê°œë…ì„ ì¢€ ê¹¨ë‹¬ì„ ìˆ˜ ìˆì—ˆë‹¤.
